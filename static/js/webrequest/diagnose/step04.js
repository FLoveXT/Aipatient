var adult04 = {
    recordId: '',
    isLast: '',
    feel: [{
        isChecked: false,
        name: "怕冷（夏天怕空调，冬天比别人冷）"
    },
    {
        isChecked: false,
        name: "怕热（冬天都怕热）"
    },
    {
        isChecked: false,
        name: "怕风（风吹觉得很冷）"
    },
    {
        isChecked: false,
        name: "忽冷忽热"
    },
    {
        isChecked: false,
        name: "上身热下身冷"
    },
    {
        isChecked: false,
        name: "下午有潮热"
    },
    {
        isChecked: false,
        name: "无以上情况"
    },

    ],
    handAndFoot: [
        {
            isChecked: false,
            name: "手脚偏冷"
        },
        {
            isChecked: false,
            name: "手脚偏热"
        },
        {
            isChecked: false,
            name: "手脚头冷"
        }
        ,
        {
            isChecked: false,
            name: "手脚心热烫"
        }
        ,
        {
            isChecked: false,
            name: "无以上情况"
        }
    ],
    sweat: [
        {
            isChecked: false,
            name: "易出汗"
        },
        {
            isChecked: false,
            name: "稍活动大汗淋漓，容易乏力感"
        }
        ,
        {
            isChecked: false,
            name: "基本不出汗"
        }
        ,
        {
            isChecked: false,
            name: "手足心出汗"
        }
        ,
        {
            isChecked: false,
            name: "半身出汗（左右半身或上下半身）"
        }
        ,
        {
            isChecked: false,
            name: "睡觉时容易盗汗"
        }
        ,
        {
            isChecked: false,
            name: "仅头部出汗"
        }
        ,
        {
            isChecked: false,
            name: "出汗有尿臭味"
        }
        ,
        {
            isChecked: false,
            name: "出汗有腥臭味"
        }
        ,
        {
            isChecked: false,
            name: "汗液呈深黄色"
        }
        ,
        {
            isChecked: false,
            name: "汗液呈红色"
        }
        ,
        {
            isChecked: false,
            name: "汗液呈绿色"
        }
        ,
        {
            isChecked: false,
            name: "汗液呈乳白色"
        }
        ,
        {
            isChecked: false,
            name: "无以上情况"
        }

    ]
    , headPharynx: [
        {
            isChecked: false,
            name: "头痛"
        },
        {
            isChecked: false,
            name: "头昏"
        },
        {
            isChecked: false,
            name: "有眩晕感"
        },
        {
            isChecked: false,
            name: "咽干"
        }
        ,
        {
            isChecked: false,
            name: "咽痒"
        }
        ,
        {
            isChecked: false,
            name: "咽痛"
        }
        ,
        {
            isChecked: false,
            name: "咽部有异物感"
        }
        ,
        {
            isChecked: false,
            name: "鼻塞"
        }
        ,
        {
            isChecked: false,
            name: "流清涕，质地稀水状"
        }
        ,
        {
            isChecked: false,
            name: "流黄或白涕（浊涕），质地粘稠"
        }
        ,
        {
            isChecked: false,
            name: "呼吸发热发烫"
        }
        ,
        {
            isChecked: false,
            name: "容易流鼻血"
        }
        ,
        {
            isChecked: false,
            name: "眼睛视物模糊"
        }
        ,
        {
            isChecked: false,
            name: "眼睛干涩"
        }
        ,
        {
            isChecked: false,
            name: "偶尔做梦"
        }
        ,
        {
            isChecked: false,
            name: "耳鸣"
        }
        ,
        {
            isChecked: false,
            name: "耳聋"
        }
        ,
        {
            isChecked: false,
            name: "听力下降"
        }
        ,
        {
            isChecked: false,
            name: "无以上情况"
        }
    ],
    cough: [
        {
            isChecked: false,
            name: "咳嗽"
        },
        {
            isChecked: false,
            name: "喘"
        },
        {
            isChecked: false,
            name: "无痰"
        },
        {
            isChecked: false,
            name: "极少"
        },
        {
            isChecked: false,
            name: "痰多"
        },
        {
            isChecked: false,
            name: "黄痰"
        },
        {
            isChecked: false,
            name: "白痰粘稠"
        },
        {
            isChecked: false,
            name: "白痰清稀"
        },
        {
            isChecked: false,
            name: "黄白痰"
        },
        {
            isChecked: false,
            name: "清稀泡沫痰"
        },
        {
            isChecked: false,
            name: "多涎沫"
        },
        {
            isChecked: false,
            name: "痰中带血丝"
        },
        {
            isChecked: false,
            name: "无以上情况"
        },
    ],
    chest: [
        {
            isChecked: false,
            name: "心慌"
        },
        {
            isChecked: false,
            name: "心悸动"
        },
        {
            isChecked: false,
            name: "胸闷"
        },
        {
            isChecked: false,
            name: "气短"
        },
        {
            isChecked: false,
            name: "胸部胀满"
        },
        {
            isChecked: false,
            name: "胸骨正中处按痛"
        },
        {
            isChecked: false,
            name: "胃痛"
        },
        {
            isChecked: false,
            name: "胃胀满"
        },
        {
            isChecked: false,
            name: "心慌嗳气"
        },
        {
            isChecked: false,
            name: "泛酸"
        },
        {
            isChecked: false,
            name: "腹胀腹痛"
        },
        {
            isChecked: false,
            name: "有气从腹部上冲"
        },
        {
            isChecked: false,
            name: "下腹部按着僵硬"
        },
        {
            isChecked: false,
            name: "两肋按着胀痛"
        },
        {
            isChecked: false,
            name: "下腹部隐隐作痛"
        },
        {
            isChecked: false,
            name: "强项后背部拘紧"
        },
        {
            isChecked: false,
            name: "无以上情况"
        },
    ],
    body: [
        {
            isChecked: false,
            name: "全身乏力懒动"
        },
        {
            isChecked: false,
            name: "身体觉得重"
        },
        {
            isChecked: false,
            name: "身痒"
        },
        {
            isChecked: false,
            name: "四肢烦疼"
        },
        {
            isChecked: false,
            name: "四肢拘紧屈伸不力"
        },
        {
            isChecked: false,
            name: "睡觉时四肢不自觉抽动"
        },
        {
            isChecked: false,
            name: "身体转侧不利索"
        },
        {
            isChecked: false,
            name: "腰痛"
        },
        {
            isChecked: false,
            name: "脚后跟痛"
        },
        {
            isChecked: false,
            name: "无以上情况"
        },
    ],
    livingHabit: [
        {
            isChecked: false,
            name: "贪食辛辣"
        },
        {
            isChecked: false,
            name: "喜食肥腻"
        },
        {
            isChecked: false,
            name: "喜食甜食"
        },
        {
            isChecked: false,
            name: "喜凉/生冷"
        },
        {
            isChecked: false,
            name: "上班久坐"
        },
        {
            isChecked: false,
            name: "房事过频"
        },
        {
            isChecked: false,
            name: "频繁手淫"
        },
        {
            isChecked: false,
            name: "长期熬夜"
        },
        {
            isChecked: false,
            name: "长期嗜酒"
        },
        {
            isChecked: false,
            name: "三餐不律"
        },
        {
            isChecked: false,
            name: "无以上情况"
        },
    ]
}


function Init() {
    var recordId = getQueryString("recordId");
    if (recordId == undefined || recordId == "" || recordId == null) {
        window.location.href = "/";
        return false;
    }
    adult04.recordId = recordId;
    var islast = getQueryString("islast");
    getWriteInfo(recordId, islast, 4);
    if (islast == "1") {
        getdetailInfo();
    }
    else {
        showLoaders();
        setTimeout(function () {
            hideLoaders();
            $(".adult04").html(template('adult04-div', { list: adult04 }));
        }, 500);
    }
}




/**
 *  身体感觉点击事件
 * @param {any} _this
 * @param {any} _index
 */
function shentiganjueOnclick(_this, _index) {
    var isCheck = false;
    if ($(_this).hasClass("active")) {
        isCheck = false;
        $(_this).removeClass("active");
    }
    else {
        isCheck = true;
        $(_this).addClass("active");
    }
    var active = adult04.feel;
    active[_index].isChecked = isCheck;
    console.log(active);
}

/**
 *   手脚
 * @param {any} _this
 * @param {any} _index
 */
function shoujiaoOnclick(_this, _index) {
    for (var i in adult04.handAndFoot) {
        if (i == _index) {
            adult04.handAndFoot[i].isChecked = true;
        } else {
            adult04.handAndFoot[i].isChecked = false;
        }
    }
    console.log(adult04.handAndFoot);
    $(_this).addClass("active").siblings().removeClass("active");
}


/**
 *  出汗点击事件
 * @param {any} _this
 * @param {any} _index
 */
function chuhanOnclick(_this, _index) {
    var isCheck = false;
    if ($(_this).hasClass("active")) {
        isCheck = false;
        $(_this).removeClass("active");
    }
    else {
        isCheck = true;
        $(_this).addClass("active");
    }
    var active = adult04.sweat;
    active[_index].isChecked = isCheck;
    console.log(active);
}

/**
 *  头咽部点击事件
 * @param {any} _this
 * @param {any} _index
 */
function touyanbuOnclick(_this, _index) {
    var isCheck = false;
    if ($(_this).hasClass("active")) {
        isCheck = false;
        $(_this).removeClass("active");
    }
    else {
        isCheck = true;
        $(_this).addClass("active");
    }
    var active = adult04.headPharynx;
    active[_index].isChecked = isCheck;
    console.log(active);
}

/**
 *  咳嗽和痰点击事件
 * @param {any} _this
 * @param {any} _index
 */
function kesouhetanOnclick(_this, _index) {
    var isCheck = false;
    if ($(_this).hasClass("active")) {
        isCheck = false;
        $(_this).removeClass("active");
    }
    else {
        isCheck = true;
        $(_this).addClass("active");
    }
    var active = adult04.cough;
    active[_index].isChecked = isCheck;
    console.log(active);
}

/**
 *  胸腹痛点击事件
 * @param {any} _this
 * @param {any} _index
 */
function xiongbutongOnclick(_this, _index) {
    var isCheck = false;
    if ($(_this).hasClass("active")) {
        isCheck = false;
        $(_this).removeClass("active");
    }
    else {
        isCheck = true;
        $(_this).addClass("active");
    }
    var active = adult04.chest;
    active[_index].isChecked = isCheck;
    console.log(active);
}

/**
 *  身体点击事件
 * @param {any} _this
 * @param {any} _index
 */
function shentiOnclick(_this, _index) {
    var isCheck = false;
    if ($(_this).hasClass("active")) {
        isCheck = false;
        $(_this).removeClass("active");
    }
    else {
        isCheck = true;
        $(_this).addClass("active");
    }
    var active = adult04.body;
    active[_index].isChecked = isCheck;
    console.log(active);
}


/**
 *  生活习惯
 * */
function shenghuoxiguanClick(_this, _index) {
    var isCheck = false;
    if ($(_this).hasClass("active")) {
        isCheck = false;
        $(_this).removeClass("active");
    }
    else {
        isCheck = true;
        $(_this).addClass("active");
    }
    var active = adult04.livingHabit;
    active[_index].isChecked = isCheck;
    console.log(active);
}




/**
 *  提交
 * */
function commitInfo() {
    var array = {
        "feel": Enumerable.From(adult04.feel).Where(t => t.isChecked == true).Select(t => t.name).ToArray(),
        "handAndFoot": adult04.handAndFoot.find(t => t.isChecked == true) ? adult04.handAndFoot.find(t => t.isChecked == true).name : "",
        "sweat": Enumerable.From(adult04.sweat).Where(t => t.isChecked == true).Select(t => t.name).ToArray(),
        "headPharynx": Enumerable.From(adult04.headPharynx).Where(t => t.isChecked == true).Select(t => t.name).ToArray(),
        "cough": Enumerable.From(adult04.cough).Where(t => t.isChecked == true).Select(t => t.name).ToArray(),
        "chest": Enumerable.From(adult04.chest).Where(t => t.isChecked == true).Select(t => t.name).ToArray(),
        "body": Enumerable.From(adult04.body).Where(t => t.isChecked == true).Select(t => t.name).ToArray(),
        "livingHabit": Enumerable.From(adult04.livingHabit).Where(t => t.isChecked == true).Select(t => t.name).ToArray(),
        "supplement": $(".content-value").val()
    };
    var api = '/api/interrogation/save_template.json';
    var parments = {
        recordId: adult04.recordId,
        templateType: 'body',
        body: array
    };
    var json = JSON.stringify(parments);
    new putJsonRequest({
        url: api,
        isShowLoader: true,
        param: json,
        callBack(res) {
            if (res.code == 200) {
                var sex = common_sex;
                if (sex == "男") {
                    url = "/pages/diagnose/step05-male.html?recordId=" + adult04.recordId;
                } else {
                    url = "/pages/diagnose/step05-female.html?recordId=" + adult04.recordId;
                }
                successSetTimeOut("第四步保存成功", url);
                return false;
            }
            else {
                errorMsg(res.message);
                return false;
            }
        }
    })
}

Init();

/**
 *   字符串补充说明
 * */
function valueStrCheck(that) {
    var length = $(that).val().length;
    var valueMin = length;
    $(".zev-min").html(valueMin);
}

/**
 *  获取详情赋值
 * */
function getdetailInfo() {
    var api = '/api/interrogation/' + adult04.recordId
    new getRequest({
        url: api,
        isShowLoader: true,
        callBack(res) {
            if (res.code == 200) {
                var data = res.data;
                var diet = data.body
                if (diet != null) {
                    var feel = diet.feel;
                    var handAndFoot = diet.handAndFoot;
                    var sweat = diet.sweat;
                    var headPharynx = diet.headPharynx;
                    var cough = diet.cough;

                    var chest = diet.chest;
                    var body = diet.body;
                    var livingHabit = diet.livingHabit;

                    var supplement = diet.supplement;

                    for (var i in adult04.feel) {
                        if (feel == null || feel == null) {
                            continue;
                        }
                        if (feel.indexOf(adult04.feel[i].name) > -1) {
                            adult04.feel[i].isChecked = true;
                        }
                    }
                    for (var i in adult04.handAndFoot) {
                        if (adult04.handAndFoot[i].name == handAndFoot) {
                            adult04.handAndFoot[i].isChecked = true;
                        }
                    }
                    for (var i in adult04.sweat) {
                        if (sweat == null || sweat == null) {
                            continue;
                        }
                        if (sweat.indexOf(adult04.sweat[i].name) > -1) {
                            adult04.sweat[i].isChecked = true;
                        }
                    }

                    for (var i in adult04.headPharynx) {
                        if (headPharynx == null || headPharynx == null) {
                            continue;
                        }
                        if (headPharynx.indexOf(adult04.headPharynx[i].name) > -1) {
                            adult04.headPharynx[i].isChecked = true;
                        }
                    }
                    for (var i in adult04.cough) {
                        if (cough == null || cough == null) {
                            continue;
                        }
                        if (cough.indexOf(adult04.cough[i].name) > -1) {
                            adult04.cough[i].isChecked = true;
                        }
                    }


                    for (var i in adult04.chest) {
                        if (chest == null || chest == null) {
                            continue;
                        }
                        if (chest.indexOf(adult04.chest[i].name) > -1) {
                            adult04.chest[i].isChecked = true;
                        }
                    }
                    for (var i in adult04.body) {
                        if (body == null || body == null) {
                            continue;
                        }
                        if (body.indexOf(adult04.body[i].name) > -1) {
                            adult04.body[i].isChecked = true;
                        }
                    }

                    for (var i in adult04.livingHabit) {
                        if (livingHabit == null || livingHabit == null) {
                            continue;
                        }
                        if (livingHabit.indexOf(adult04.livingHabit[i].name) > -1) {
                            adult04.livingHabit[i].isChecked = true;
                        }
                    }

                 
               
                    var content = supplement;
                    contentWrite(content);
                    showLoaders();
                    setTimeout(function () {
                        hideLoaders();
                        $(".adult04").html(template('adult04-div', { list: adult04 }));
                    }, 500);
                }
            }
            else {
                errorMsg(res.message);
                return false;
            }
        }
    })
}

/**
 *  内容写入
 * */
function contentWrite(data) {
    $(".content-value").val(data);
    var datalength = data.length;
    $(".zev-min").html(datalength);
}
